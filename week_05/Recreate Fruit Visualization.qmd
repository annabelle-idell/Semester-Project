---
title: "Recreate - Visualization"
format: 
  html:
    code-line-numbers: true
    code-fold: true
execute: 
  keep-md: true
editor: visual
warnings: false
---

```{r}
library(tidyverse)
library(countrycode)
library(ggplot2)
library(ggrepel)
library(gganimate)
library(av)
library(gifski)
```


```{r}
df_fruit <- read_csv("https://ourworldindata.org/grapher/fruit-consumption-vs-gdp-per-capita.csv?v=1&csvType=full&useColumnShortNames=true")
```


```{r}
fruit <- df_fruit %>%
  mutate(Continent = countrycode(Entity, origin = "country.name", destination = "continent")) %>% 
  filter(!is.na(ny_gdp_pcap_pp_kd)) %>%
  rename("fruit_supply" = fruit__00002919__food_available_for_consumption__0645pc__kilograms_per_year_per_capita) %>%
  filter(!is.na(fruit_supply))

```

## Fruit consumption vs. GDP per capita

```{r}
ggplot(fruit, aes(x = ny_gdp_pcap_pp_kd, y = fruit_supply, color = Continent)) +
  geom_point(pch = 20) +
  transition_states(Year) +
  labs(title = "Fruit consumption vs. GDP per capita",
       subtitle = "Average per capita fruit supply, measured in kilograms per year versus gross domestic product (GDP) per capita, adjusted \nfor inflation and for differences in living costs between countries.",
       x = "GDP per capita (international-$ in 2021 prices)", 
       y = "Fruit supply per person (kilograms per year)",
       caption = "Data source: Food and Agriculture Organization of the United Nations (2024); Data compiled from multiple sources by World Bank (2025) – Learn more about this data \nNote: GDP per capita is expressed in international-$ at 2021 prices.
\nOurWorldinData.org/diet-compositions | CC BY") +
  coord_cartesian(xlim = c(0, 100000)) +
  theme_minimal()

```

## Kenya, Ghana, and the United States

```{r}
specific <- fruit %>% 
  filter(Entity %in% c("Kenya", "Ghana", "United States"))

ggplot(fruit, aes(x = ny_gdp_pcap_pp_kd, y = fruit_supply, color = Continent)) +
  geom_point() +
  geom_point(data = specific, aes(x = ny_gdp_pcap_pp_kd, y = fruit_supply), pch = 21, size = 2, color = "black") +
  labs(title = "Fruit consumption vs. GDP per capita: Kenya, Ghana, United States",
       subtitle = "Average per capita fruit supply, measured in kilograms per year versus gross domestic product (GDP) per capita, adjusted \nfor inflation and for differences in living costs between countries.",
       x = "GDP per capita (international-$ in 2021 prices)", 
       y = "Fruit supply per person (kilograms per year)",
       caption = "Data source: Food and Agriculture Organization of the United Nations (2024); Data compiled from multiple sources by World Bank (2025) – Learn more about this data \nNote: GDP per capita is expressed in international-$ at 2021 prices.
\nOurWorldinData.org/diet-compositions | CC BY") +
  coord_cartesian(xlim = c(0, 100000)) +
  theme_minimal()

```

## Oceania

```{r}
specific2 <- fruit %>% 
  filter(Continent == "Oceania")

ggplot(fruit, aes(x = ny_gdp_pcap_pp_kd, y = fruit_supply, color = Continent)) +
  geom_point() +
  geom_point(data = specific2, aes(x = ny_gdp_pcap_pp_kd, y = fruit_supply), pch = 21, size = 2, color = "black") +
  labs(title = "Fruit consumption vs. GDP per capita: Oceania",
       subtitle = "Average per capita fruit supply, measured in kilograms per year versus gross domestic product (GDP) per capita, adjusted \nfor inflation and for differences in living costs between countries.",
       x = "GDP per capita (international-$ in 2021 prices)", 
       y = "Fruit supply per person (kilograms per year)",
       caption = "Data source: Food and Agriculture Organization of the United Nations (2024); Data compiled from multiple sources by World Bank (2025) – Learn more about this data \nNote: GDP per capita is expressed in international-$ at 2021 prices.
\nOurWorldinData.org/diet-compositions | CC BY") +
  coord_cartesian(xlim = c(0, 100000)) +
  theme_minimal()


```

This was a challenging assignment, and I still feel that I could've done better with more time. I discovered that the chart looks very different when using a linear vs. logarithmic scale, because the website default is logarithmic but the linear model matches mine much closer. I also realized I am not confident in using axis, plot, and legend aspects to polish a graph. However, I did learn how to create a moving graph that tells the story over time, although it did not match the visual perfectly, and this was exciting and helped the graph tell a better story. Emphasizing different aspects of data also draws the eyes and highlights patterns and gives more meaning to the data. I used layering to highlight certain points, as well as ssize adjustments and color contrast. 
